<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HID SCT Self-Assessment Grid - Editable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0d6efd;
            --secondary: #6c757d;
            --success: #198754;
            --info: #0dcaf0;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7f9;
            padding: 20px 0;
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .sidebar {
            background-color: #2c3e50;
            color: white;
            height: 100vh;
            position: sticky;
            top: 0;
            padding-top: 20px;
            overflow-y: auto;
        }
        
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            border-left: 3px solid transparent;
            padding: 10px 15px;
            margin: 5px 0;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
            border-left-color: var(--info);
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .main-content {
            padding: 20px;
            max-height: 100vh;
            overflow-y: auto;
        }
        
        .progress-sidebar {
            background-color: #f8f9fa;
            height: 100vh;
            position: sticky;
            top: 0;
            padding: 20px 15px;
            overflow-y: auto;
            border-left: 1px solid #e9ecef;
        }
        
        .progress-bar-container {
            background-color: #e9ecef;
            border-radius: 5px;
            margin-bottom: 20px;
            height: 30px;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .section-card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 8px;
        }
        
        .section-header {
            background-color: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            border-radius: 8px 8px 0 0;
        }
        
        .assessment-item {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .assessment-item:last-child {
            border-bottom: none;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .comments-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            border-top: 1px solid #e9ecef;
        }
        
        .overview-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .overview-card .card-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .assessment-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .assessment-table th, .assessment-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
            vertical-align: middle;
        }
        
        .assessment-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .score-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .score-0 { background: #fee2e2; color: #dc2626; }
        .score-1 { background: #fed7aa; color: #ea580c; }
        .score-2 { background: #fef3c7; color: #ca8a04; }
        .score-3 { background: #d1fae5; color: #059669; }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        .progress-sidebar-table {
            width: 100%;
            font-size: 0.85rem;
        }
        
        .progress-sidebar-table th, .progress-sidebar-table td {
            padding: 8px 5px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .progress-sidebar-table th {
            font-weight: 600;
        }
        
        .progress-sidebar-table tr:last-child td {
            border-bottom: none;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .summary-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .file-input {
            display: none;
        }
        
        @media (max-width: 992px) {
            .progress-sidebar {
                display: none;
            }
            
            .main-content {
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                height: auto;
                position: relative;
            }
            
            .assessment-table {
                font-size: 0.9rem;
                display: block;
                overflow-x: auto;
            }
            
            .assessment-table th, .assessment-table td {
                padding: 8px;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="row g-0">
            <div class="col-lg-2">
                <div class="sidebar">
                    <h4 class="text-center mb-4">HID SCT Assessment</h4>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#info" data-bs-toggle="tab">
                                <i class="fas fa-info-circle"></i> INFO
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#definition" data-bs-toggle="tab">
                                <i class="fas fa-book"></i> DEFINITION
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#org-detail" data-bs-toggle="tab">
                                <i class="fas fa-building"></i> ORGANIZATIONAL DETAIL
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#guiding-principles" data-bs-toggle="tab">
                                <i class="fas fa-star"></i> GUIDING PRINCIPLES
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#core-standards" data-bs-toggle="tab">
                                <i class="fas fa-cogs"></i> CORE STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#clinical-standards" data-bs-toggle="tab">
                                <i class="fas fa-stethoscope"></i> CLINICAL STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#logistic-standards" data-bs-toggle="tab">
                                <i class="fas fa-truck"></i> LOGISTIC STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#wash-standards" data-bs-toggle="tab">
                                <i class="fas fa-hand-holding-water"></i> WASH STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#summary" data-bs-toggle="tab">
                                <i class="fas fa-file-alt"></i> SUMMARY
                            </a>
                        </li>
                    </ul>
                    <div class="mt-4 p-3">
                        <div class="progress-bar-container">
                            <div class="progress-bar bg-success" id="overallProgressBar" style="width: 0%"></div>
                        </div>
                        <p class="mb-1">Overall Completion</p>
                        <h5 class="text-center" id="overallProgressText">0%</h5>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-8">
                <div class="main-content">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="info">
                            <h2 class="mb-4">Self-Assessment Checklist for Emergency Medical Teams</h2>
                            <div class="card section-card">
                                <div class="card-body">
                                    <h5 class="card-title">Minimum Standards for Highly Infectious Disease (HID) Specialized Care Team (SCT) – AWD Inpatient</h5>
                                    <p class="card-text">
                                        This self-assessment tool is designed to help HID SCTs evaluate their readiness and capabilities according to the established minimum standards.
                                    </p>
                                    <p class="card-text">
                                        Use this digital tool to complete your assessment, track progress, and generate reports for your organization and the coordination mechanism.
                                    </p>
                                    <p class="text-muted">Version 1.0/2025</p>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-check-circle fa-2x text-success"></i>
                                        <h5>Completed Sections</h5>
                                        <div class="card-value" id="completedSections">0/8</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-chart-line fa-2x text-primary"></i>
                                        <h5>Overall Score</h5>
                                        <div class="card-value" id="overallScore">0%</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-clock fa-2x text-warning"></i>
                                        <h5>Last Updated</h5>
                                        <div class="card-value" id="lastUpdated">Today</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="definition">
                            <h2 class="mb-4">Technical Standards Definition</h2>
                            <div class="card section-card">
                                <div class="card-body">
                                    <p>
                                        HID SCTs are national or international teams deployed at the request of the Ministry of Health (MOH)/ coordination cell of the host country. 
                                        The HID SCT's modality of deployment (embed, coupled or self-sustained) depends on context and defined capacity/level of care.
                                    </p>
                                    <p>
                                        Depending on modality of deployment, some operations support, logistics and WASH elements may be provided by a host facility.
                                    </p>
                                    <p>
                                        The level of required support needs to be clarified prior to any deployment, and agreed by teams, receiving facilities and the coordination mechanism. 
                                        Teams must have SOPs in place that clearly state the minimum support requirements that need to be provided by the host facility in order to deploy. 
                                        Teams with greater operational independence have greater flexibility and are more likely to be requested to deploy.
                                    </p>
                                    <p>
                                        Regardless of the modality of deployment, teams need to ensure self-sufficiency and the ability to provide all the required equipment and consumables to deliver their services as defined by 
                                        "Minimum standards and recommendations for medical teams responding to highly infectious disease outbreaks" for the entire period of their deployment. 
                                        All teams opting for an embedded or coupled modality of deployment MUST communicate with the receiving facility to determine, 
                                        which specialist equipment or consumables might be available and to understand local procurement challenges. 
                                        Teams should always plan for contingencies and deploy with increased quantities of required equipment and consumables if resupply is likely to be challenging. 
                                        HID SCTs needs to declare their intended length of stay (including potential staff rotations) to the EMT coordination mechanism (EMTCC)/Ministry of Health in their Expression of Interest.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="org-detail">
                            <h2 class="mb-4">Organizational Details</h2>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Team Information</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="teamName" class="form-label">Team Name</label>
                                            <input type="text" class="form-control" id="teamName">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="region" class="form-label">Region</label>
                                            <input type="text" class="form-control" id="region">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="country" class="form-label">Country</label>
                                            <input type="text" class="form-control" id="country">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="mentorName" class="form-label">Mentor Name</label>
                                            <input type="text" class="form-control" id="mentorName">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Contact Information</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <h6>Headquarters Contact</h6>
                                            <div class="mb-2">
                                                <label class="form-label">Name</label>
                                                <input type="text" class="form-control" id="hqName">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" id="hqEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Phone</label>
                                                <input type="tel" class="form-control" id="hqPhone">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Position</label>
                                                <input type="text" class="form-control" id="hqPosition">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Operations Contact</h6>
                                            <div class="mb-2">
                                                <label class="form-label">Name</label>
                                                <input type="text" class="form-control" id="opsName">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" id="opsEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Phone</label>
                                                <input type="tel" class="form-control" id="opsPhone">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Position</label>
                                                <input type="text" class="form-control" id="opsPosition">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Progress Overview</h5>
                                </div>
                                <div class="card-body">
                                    <table class="table table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Section</th>
                                                <th>Weight</th>
                                                <th>Status</th>
                                                <th>% Completed</th>
                                            </tr>
                                        </thead>
                                        <tbody id="progressTableBody">
                                            </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="guiding-principles">
                            <h2 class="mb-4">Guiding Principles</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Guiding Principles Compliance</h5>
                                    <div class="score-display" id="guidingPrinciplesScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody data-section="guiding-principles">
                                        <tr>
                                            <td>Safe Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="safe-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Equitable Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="equitable-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Ethical Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="ethical-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Accountable Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="accountable-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Appropriate Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="appropriate-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Coordinated Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="coordinated-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="guidingPrinciplesComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="guidingPrinciplesComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="core-standards">
                            <h2 class="mb-4">Core Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Core Standards Compliance</h5>
                                    <div class="score-display" id="coreStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody data-section="core-standards">
                                        <tr>
                                            <td>Administration & Organizational Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="admin-management">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Human Resources</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="human-resources">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Professional Licensing & Conduct</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="professional-licensing">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Training of Teams</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="training-teams">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Coordination of EMTs</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="coordination-emts">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Records and Reporting</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="records-reporting">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="coreStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="coreStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="clinical-standards">
                            <h2 class="mb-4">Clinical Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Clinical Standards Compliance</h5>
                                    <div class="score-display" id="clinicalStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                            <th width="5%"></th>
                                        </tr>
                                    </thead>
                                    <tbody data-section="clinical-standards">
                                        <tr>
                                            <td>Screening - SCTs/EMTs have established screening systems</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="screening">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Triage - SCTs/EMTs have established triage systems</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="triage">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Treatment - SCT/EMT provides a systematic treatment plan</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="treatment">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Obstetric & Newborn Care</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="obstetric-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-outline-success mt-2 add-row" data-section="clinical-standards">
                                    <i class="fas fa-plus me-2"></i>Añadir Subsección
                                </button>
                                <div class="comments-section">
                                    <label for="clinicalStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="clinicalStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="logistic-standards">
                            <h2 class="mb-4">Logistic Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Logistic Standards Compliance</h5>
                                    <div class="score-display" id="logisticStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                            <th width="5%"></th>
                                        </tr>
                                    </thead>
                                    <tbody data-section="logistic-standards">
                                        <tr>
                                            <td>Power and Fuel - SCTs/EMTs must ensure sufficient power supply</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="power-fuel">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Communications - SCTs/EMTs must have communication capabilities</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="communications">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Transportation & Fleet</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="transportation">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Warehouse Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="warehouse">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-outline-success mt-2 add-row" data-section="logistic-standards">
                                    <i class="fas fa-plus me-2"></i>Añadir Subsección
                                </button>
                                <div class="comments-section">
                                    <label for="logisticStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="logisticStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="wash-standards">
                            <h2 class="mb-4">WASH Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>WASH Standards Compliance</h5>
                                    <div class="score-display" id="washStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                            <th width="5%"></th>
                                        </tr>
                                    </thead>
                                    <tbody data-section="wash-standards">
                                        <tr>
                                            <td>Water Supply - SCTs/EMTs must ensure sufficient safe drinking water</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="water-supply">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Hygiene - SCTs/EMTs must ensure safe hygiene measures</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="hygiene">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Environmental Cleaning</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="cleaning">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Healthcare Waste Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="waste-management">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                            <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-outline-success mt-2 add-row" data-section="wash-standards">
                                    <i class="fas fa-plus me-2"></i>Añadir Subsección
                                </button>
                                <div class="comments-section">
                                    <label for="washStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="washStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="summary">
                            <h2 class="mb-4">Summary & Action Plan</h2>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Overall Readiness Assessment</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="strengths" class="form-label"><strong>Strengths Identified:</strong></label>
                                        <textarea class="form-control summary-textarea" id="strengths" placeholder="List the top 3-5 strengths identified through the assessment..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="criticalGaps" class="form-label"><strong>Critical Gaps Requiring Immediate Action:</strong></label>
                                        <textarea class="form-control summary-textarea" id="criticalGaps" placeholder="List the critical gaps that need immediate attention..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><strong>Timeline for Addressing Gaps:</strong></label>
                                        <div class="mb-2">
                                            <label class="form-label">Immediate (0-1 month):</label>
                                            <textarea class="form-control summary-textarea" id="immediateActions" placeholder="Actions to be taken immediately..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Short-term (1-3 months):</label>
                                            <textarea class="form-control summary-textarea" id="shortTermActions" placeholder="Actions for the next 1-3 months..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Medium-term (3-6 months):</label>
                                            <textarea class="form-control summary-textarea" id="mediumTermActions" placeholder="Actions for 3-6 months..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><strong>Support Required:</strong></label>
                                        <div class="mb-2">
                                            <label class="form-label">Technical assistance needed:</label>
                                            <textarea class="form-control summary-textarea" id="technicalAssistance" placeholder="Describe technical support requirements..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Training requirements:</label>
                                            <textarea class="form-control summary-textarea" id="trainingRequirements" placeholder="List training needs..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Resource requirements:</label>
                                            <textarea class="form-control summary-textarea" id="resourceRequirements" placeholder="Specify resource needs..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="nextSteps" class="form-label"><strong>Next Steps:</strong></label>
                                        <textarea class="form-control summary-textarea" id="nextSteps" placeholder="1. First priority action&#10;2. Second priority action&#10;3. Third priority action"></textarea>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="completionDate" class="form-label">Date of Completion:</label>
                                            <input type="date" class="form-control" id="completionDate">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="reviewedBy" class="form-label">Reviewed by:</label>
                                            <input type="text" class="form-control" id="reviewedBy" placeholder="Name and title">
                                        </div>
                                    </div>
                                    
                                    <div class="mt-3">
                                        <label for="mentorAssignment" class="form-label">Mentor Assignment (if applicable):</label>
                                        <input type="text" class="form-control" id="mentorAssignment" placeholder="Mentor name and contact">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <div>
                            <button class="btn btn-outline-secondary" id="btn-import-excel">
                                <i class="fas fa-upload me-2"></i>Import Excel
                            </button>
                            <button class="btn btn-outline-secondary" id="btn-export-json">
                                <i class="fas fa-download me-2"></i>Export JSON
                            </button>
                        </div>
                        <div>
                            <button class="btn btn-outline-primary me-2" id="btn-save">
                                <i class="fas fa-save me-2"></i>Save Draft
                            </button>
                            <button class="btn btn-outline-info me-2" id="btn-export-excel">
                                <i class="fas fa-file-excel me-2"></i>Export to Excel
                            </button>
                            <button class="btn btn-success" id="btn-submit">
                                <i class="fas fa-check-circle me-2"></i>Submit Assessment
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-2">
                <div class="progress-sidebar">
                    <h5 class="mb-3">Progress Overview</h5>
                    <div class="progress-bar-container mb-3">
                        <div class="progress-bar bg-success" id="sidebarProgressBar" style="width: 0%"></div>
                    </div>
                    <p class="mb-1">Overall Completion</p>
                    <h5 class="text-center mb-4" id="sidebarProgressText">0%</h5>
                    
                    <table class="progress-sidebar-table">
                        <thead>
                            <tr>
                                <th>Section</th>
                                <th>Status</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody id="progressSidebarBody">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" class="file-input" accept=".xlsx, .xls">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Data storage
        let assessmentData = {
            teamInfo: {},
            scores: {},
            evidence: {},
            gaps: {},
            actions: {},
            comments: {},
            summary: {}
        };

        // Initialize from localStorage if available
        function initializeData() {
            const saved = localStorage.getItem('hidSCTAssessment');
            if (saved) {
                assessmentData = JSON.parse(saved);
                loadSavedData();
            }
            updateProgress();
        }

        // Load saved data into form
        function loadSavedData() {
            // Load team info
            if (assessmentData.teamInfo) {
                Object.keys(assessmentData.teamInfo).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.teamInfo[key];
                    }
                });
            }

            // Load scores and related data
            document.querySelectorAll('.score-select').forEach(select => {
                const key = `${select.dataset.section}-${select.dataset.item}`;
                if (assessmentData.scores[key]) {
                    select.value = assessmentData.scores[key];
                    updateScoreBadge(select);
                }
                
                const row = select.closest('tr');
                if (row) {
                    const evidenceInput = row.querySelector('.evidence-input');
                    const gapsInput = row.querySelector('.gaps-input');
                    const actionInput = row.querySelector('.action-input');
                    const standardInput = row.querySelector('.standard-input');

                    if (evidenceInput && assessmentData.evidence[key]) {
                        evidenceInput.value = assessmentData.evidence[key];
                    }
                    if (gapsInput && assessmentData.gaps[key]) {
                        gapsInput.value = assessmentData.gaps[key];
                    }
                    if (actionInput && assessmentData.actions[key]) {
                        actionInput.value = assessmentData.actions[key];
                    }
                    if (standardInput && assessmentData.standard[key]) {
                        standardInput.value = assessmentData.standard[key];
                    }
                }
            });

            // Load comments
            if (assessmentData.comments) {
                Object.keys(assessmentData.comments).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.comments[key];
                    }
                });
            }

            // Load summary
            if (assessmentData.summary) {
                Object.keys(assessmentData.summary).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.summary[key];
                    }
                });
            }
        }

        // Save progress
        function saveProgress() {
            // Save team info
            assessmentData.teamInfo = {
                teamName: document.getElementById('teamName').value,
                region: document.getElementById('region').value,
                country: document.getElementById('country').value,
                mentorName: document.getElementById('mentorName').value,
                hqName: document.getElementById('hqName').value,
                hqEmail: document.getElementById('hqEmail').value,
                hqPhone: document.getElementById('hqPhone').value,
                hqPosition: document.getElementById('hqPosition').value,
                opsName: document.getElementById('opsName').value,
                opsEmail: document.getElementById('opsEmail').value,
                opsPhone: document.getElementById('opsPhone').value,
                opsPosition: document.getElementById('opsPosition').value
            };

            // Save scores and related data
            assessmentData.scores = {};
            assessmentData.evidence = {};
            assessmentData.gaps = {};
            assessmentData.actions = {};
            assessmentData.standard = {};

            document.querySelectorAll('.score-select').forEach(select => {
                const key = `${select.dataset.section}-${select.dataset.item}`;
                const row = select.closest('tr');
                
                if (select.value) {
                    assessmentData.scores[key] = select.value;
                }

                const evidenceInput = row.querySelector('.evidence-input');
                const gapsInput = row.querySelector('.gaps-input');
                const actionInput = row.querySelector('.action-input');
                const standardTextarea = row.querySelector('.standard-input');

                if (evidenceInput) {
                    assessmentData.evidence[key] = evidenceInput.value;
                }
                if (gapsInput) {
                    assessmentData.gaps[key] = gapsInput.value;
                }
                if (actionInput) {
                    assessmentData.actions[key] = actionInput.value;
                }
                if (standardTextarea) {
                    assessmentData.standard[key] = standardTextarea.value;
                }
            });

            // Save comments
            assessmentData.comments = {
                guidingPrinciplesComments: document.getElementById('guidingPrinciplesComments').value,
                coreStandardsComments: document.getElementById('coreStandardsComments').value,
                clinicalStandardsComments: document.getElementById('clinicalStandardsComments').value,
                logisticStandardsComments: document.getElementById('logisticStandardsComments').value,
                washStandardsComments: document.getElementById('washStandardsComments').value
            };

            // Save summary
            assessmentData.summary = {
                strengths: document.getElementById('strengths').value,
                criticalGaps: document.getElementById('criticalGaps').value,
                immediateActions: document.getElementById('immediateActions').value,
                shortTermActions: document.getElementById('shortTermActions').value,
                mediumTermActions: document.getElementById('mediumTermActions').value,
                technicalAssistance: document.getElementById('technicalAssistance').value,
                trainingRequirements: document.getElementById('trainingRequirements').value,
                resourceRequirements: document.getElementById('resourceRequirements').value,
                nextSteps: document.getElementById('nextSteps').value,
                completionDate: document.getElementById('completionDate').value,
                reviewedBy: document.getElementById('reviewedBy').value,
                mentorAssignment: document.getElementById('mentorAssignment').value
            };

            localStorage.setItem('hidSCTAssessment', JSON.stringify(assessmentData));
            
            showNotification('Progress saved successfully!');
            updateProgress();
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Update score badge
        function updateScoreBadge(select) {
            const value = select.value;
            select.className = 'form-select score-select';
            if (value !== '' && value !== 'NA') {
                select.classList.add(`score-${value}`);
            }
        }

        // Calculate scores and update progress
        function updateProgress() {
            let totalScore = 0;
            let maxPossibleScore = 0;
            let completedSectionsCount = 0;
            
            const sectionProgress = {
                'guiding-principles': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0, weight: 2 },
                'core-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0, weight: 18 },
                'clinical-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0, weight: 20 },
                'logistic-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0, weight: 10 },
                'wash-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0, weight: 10 }
            };

            document.querySelectorAll('.score-select').forEach(select => {
                const section = select.dataset.section;
                if (sectionProgress[section]) {
                    sectionProgress[section].totalItems++;
                    
                    if (select.value && select.value !== '') {
                        sectionProgress[section].scoredItems++;
                        
                        if (select.value !== 'NA') {
                            const score = parseInt(select.value);
                            sectionProgress[section].score += score;
                            sectionProgress[section].maxScore += 3;
                        }
                    }
                }
            });

            const totalWeight = Object.values(sectionProgress).reduce((sum, s) => sum + s.weight, 0);

            // Update section scores and calculate weighted overall score
            Object.keys(sectionProgress).forEach(section => {
                const progress = sectionProgress[section];
                let percentage = 0;
                
                if (progress.maxScore > 0) {
                    percentage = Math.round((progress.score / progress.maxScore) * 100);
                }

                if (progress.totalItems > 0 && progress.scoredItems === progress.totalItems) {
                    completedSectionsCount++;
                }
                
                totalScore += progress.score;
                maxPossibleScore += progress.maxScore;

                const scoreElement = document.getElementById(`${section}Score`);
                if (scoreElement) {
                    scoreElement.textContent = `${percentage}% Complete`;
                }
            });

            // Update overall progress
            const overallProgress = maxPossibleScore > 0 ? Math.round((totalScore / maxPossibleScore) * 100) : 0;
            
            document.getElementById('overallProgressBar').style.width = `${overallProgress}%`;
            document.getElementById('overallProgressText').textContent = `${overallProgress}%`;
            document.getElementById('sidebarProgressBar').style.width = `${overallProgress}%`;
            document.getElementById('sidebarProgressText').textContent = `${overallProgress}%`;
            
            document.getElementById('completedSections').textContent = `${completedSectionsCount}/5`;
            document.getElementById('overallScore').textContent = `${overallProgress}%`;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString();

            // Update progress table
            const progressTableBody = document.getElementById('progressTableBody');
            progressTableBody.innerHTML = '';
            
            const sectionsWithWeight = [
                { name: 'GUIDING PRINCIPLES', weight: 2, section: 'guiding-principles' },
                { name: 'CORE STANDARDS', weight: 18, section: 'core-standards' },
                { name: 'CLINICAL STANDARDS', weight: 20, section: 'clinical-standards' },
                { name: 'LOGISTIC STANDARDS', weight: 10, section: 'logistic-standards' },
                { name: 'WASH STANDARDS', weight: 10, section: 'wash-standards' }
            ];
            
            let totalWeightedCompleted = 0;
            
            sectionsWithWeight.forEach(s => {
                const progress = sectionProgress[s.section];
                let completed = 0;
                
                if (progress.maxScore > 0) {
                    completed = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const weight = s.weight;
                const completedWeight = (weight * completed) / 100;
                
                totalWeightedCompleted += completedWeight;
                
                const status = completed === 0 ? 'Not Started' : 
                              completed < 100 ? 'In Progress' : 'Completed';
                const badgeClass = status === 'Completed' ? 'bg-success' : 
                                 status === 'In Progress' ? 'bg-warning' : 'bg-secondary';
                
                progressTableBody.innerHTML += `
                    <tr>
                        <td>${s.name}</td>
                        <td>${weight}%</td>
                        <td><span class="badge ${badgeClass}">${status}</span></td>
                        <td>${completed}%</td>
                    </tr>
                `;
            });
            
            const finalWeightedScore = Math.round((totalWeightedCompleted / totalWeight) * 100);
            progressTableBody.innerHTML += `
                <tr class="table-primary fw-bold">
                    <td>TOTAL</td>
                    <td>${totalWeight}%</td>
                    <td></td>
                    <td>${finalWeightedScore}%</td>
                </tr>
            `;
            
            // Update progress sidebar
            const progressSidebarBody = document.getElementById('progressSidebarBody');
            progressSidebarBody.innerHTML = '';
            
            sectionsWithWeight.forEach(s => {
                const progress = sectionProgress[s.section];
                let completed = 0;
                
                if (progress.maxScore > 0) {
                    completed = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const status = completed === 0 ? 'Not Started' : 
                              completed < 100 ? 'In Progress' : 'Completed';
                const badgeClass = status === 'Completed' ? 'bg-success' : 
                                 status === 'In Progress' ? 'bg-warning' : 'bg-secondary';
                
                progressSidebarBody.innerHTML += `
                    <tr>
                        <td>${s.name.split(' ')[0]}</td>
                        <td><span class="badge ${badgeClass}">${status}</span></td>
                        <td>${completed}%</td>
                    </tr>
                `;
            });
        }

        // Export to Excel
        function exportToExcel() {
            saveProgress();
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            
            // Sheet 1: Team Information
            const teamInfoData = [
                ['Team Information', ''],
                ['Team Name', assessmentData.teamInfo.teamName || ''],
                ['Region', assessmentData.teamInfo.region || ''],
                ['Country', assessmentData.teamInfo.country || ''],
                ['Mentor Name', assessmentData.teamInfo.mentorName || ''],
                [''],
                ['Headquarters Contact', ''],
                ['Name', assessmentData.teamInfo.hqName || ''],
                ['Email', assessmentData.teamInfo.hqEmail || ''],
                ['Phone', assessmentData.teamInfo.hqPhone || ''],
                ['Position', assessmentData.teamInfo.hqPosition || ''],
                [''],
                ['Operations Contact', ''],
                ['Name', assessmentData.teamInfo.opsName || ''],
                ['Email', assessmentData.teamInfo.opsEmail || ''],
                ['Phone', assessmentData.teamInfo.opsPhone || ''],
                ['Position', assessmentData.teamInfo.opsPosition || '']
            ];
            const teamInfoWs = XLSX.utils.aoa_to_sheet(teamInfoData);
            XLSX.utils.book_append_sheet(wb, teamInfoWs, 'Team Info');

            // Sheet 2: Progress Overview
            const progressOverviewData = [
                ['Section', 'Weight', 'Status', '% Completed']
            ];
            
            const sectionProgress = calculateSectionProgress();
            const sections = [
                { name: 'GUIDING PRINCIPLES', weight: 2, section: 'guiding-principles' },
                { name: 'CORE STANDARDS', weight: 18, section: 'core-standards' },
                { name: 'CLINICAL STANDARDS', weight: 20, section: 'clinical-standards' },
                { name: 'LOGISTIC STANDARDS', weight: 10, section: 'logistic-standards' },
                { name: 'WASH STANDARDS', weight: 10, section: 'wash-standards' }
            ];
            
            sections.forEach(s => {
                const progress = sectionProgress[s.section];
                let completed = 0;
                
                if (progress.maxScore > 0) {
                    completed = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const status = completed === 0 ? 'Not Started' : 
                              completed < 100 ? 'In Progress' : 'Completed';
                
                progressOverviewData.push([s.name, s.weight + '%', status, completed + '%']);
            });
            
            const progressOverviewWs = XLSX.utils.aoa_to_sheet(progressOverviewData);
            XLSX.utils.book_append_sheet(wb, progressOverviewWs, 'Progress Overview');

            // Sheet 3: Assessment Data
            const data = [];
            data.push(['Standard ID', 'Pillar', 'Standard Statement', 'Score', 'Evidence', 'Gaps', 'Actions', 'Comments']);
            
            document.querySelectorAll('.score-select').forEach(select => {
                const row = select.closest('tr');
                const standardCell = row.cells[0];
                const standardText = standardCell.querySelector('textarea') ? standardCell.querySelector('textarea').value : standardCell.textContent.trim();
                const section = select.dataset.section;
                const key = `${select.dataset.section}-${select.dataset.item}`;
                
                const pillar = section === 'guiding-principles' ? 'Guiding Principles' :
                              section === 'core-standards' ? 'Core Standards' :
                              section === 'clinical-standards' ? 'Clinical Standards' :
                              section === 'logistic-standards' ? 'Logistic Standards' :
                              section === 'wash-standards' ? 'WASH Standards' : 'Other';
                
                const evidenceInput = row.querySelector('.evidence-input');
                const gapsInput = row.querySelector('.gaps-input');
                const actionInput = row.querySelector('.action-input');
                
                data.push([
                    key,
                    pillar,
                    standardText,
                    select.value || '',
                    evidenceInput ? evidenceInput.value : '',
                    gapsInput ? gapsInput.value : '',
                    actionInput ? actionInput.value : '',
                    assessmentData.comments[`${section}Comments`] || ''
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, 'HID SCT Assessment');

            // Sheet 4: Summary
            const summaryData = [
                ['Summary Section', 'Content'],
                ['Strengths Identified', assessmentData.summary.strengths || ''],
                ['Critical Gaps', assessmentData.summary.criticalGaps || ''],
                ['Immediate Actions (0-1 month)', assessmentData.summary.immediateActions || ''],
                ['Short-term Actions (1-3 months)', assessmentData.summary.shortTermActions || ''],
                ['Medium-term Actions (3-6 months)', assessmentData.summary.mediumTermActions || ''],
                ['Technical Assistance Needed', assessmentData.summary.technicalAssistance || ''],
                ['Training Requirements', assessmentData.summary.trainingRequirements || ''],
                ['Resource Requirements', assessmentData.summary.resourceRequirements || ''],
                ['Next Steps', assessmentData.summary.nextSteps || ''],
                ['Completion Date', assessmentData.summary.completionDate || ''],
                ['Reviewed By', assessmentData.summary.reviewedBy || ''],
                ['Mentor Assignment', assessmentData.summary.mentorAssignment || '']
            ];
            
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, 'Summary');
            
            // Export the workbook
            XLSX.writeFile(wb, `HID_SCT_Assessment_${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('Data exported to Excel successfully!');
        }

        // Function to calculate section progress (similar to updateProgress but without UI updates)
        function calculateSectionProgress() {
            const sectionProgress = {
                'guiding-principles': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0 },
                'core-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0 },
                'clinical-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0 },
                'logistic-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0 },
                'wash-standards': { totalItems: 0, scoredItems: 0, score: 0, maxScore: 0 }
            };

            document.querySelectorAll('.score-select').forEach(select => {
                const section = select.dataset.section;
                if (sectionProgress[section]) {
                    sectionProgress[section].totalItems++;
                    
                    if (select.value && select.value !== '') {
                        sectionProgress[section].scoredItems++;
                        
                        if (select.value !== 'NA') {
                            const score = parseInt(select.value);
                            sectionProgress[section].score += score;
                            sectionProgress[section].maxScore += 3;
                        }
                    }
                }
            });

            return sectionProgress;
        }

        // Export to JSON
        function exportToJSON() {
            saveProgress();
            
            const dataStr = JSON.stringify(assessmentData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `HID_SCT_Assessment_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('Data exported to JSON successfully!');
        }

        // Import from Excel
        function importFromExcel(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Reset assessment data
                    assessmentData = {
                        teamInfo: {},
                        scores: {},
                        evidence: {},
                        gaps: {},
                        actions: {},
                        comments: {},
                        summary: {},
                        standard: {}
                    };
                    
                    // Import Team Info
                    if (workbook.Sheets['Team Info']) {
                        const teamInfoSheet = workbook.Sheets['Team Info'];
                        const teamInfoData = XLSX.utils.sheet_to_json(teamInfoSheet, { header: 1 });
                        
                        // Extract team info from the structured data
                        assessmentData.teamInfo = {
                            teamName: teamInfoData[1] ? teamInfoData[1][1] || '' : '',
                            region: teamInfoData[2] ? teamInfoData[2][1] || '' : '',
                            country: teamInfoData[3] ? teamInfoData[3][1] || '' : '',
                            mentorName: teamInfoData[4] ? teamInfoData[4][1] || '' : '',
                            hqName: teamInfoData[7] ? teamInfoData[7][1] || '' : '',
                            hqEmail: teamInfoData[8] ? teamInfoData[8][1] || '' : '',
                            hqPhone: teamInfoData[9] ? teamInfoData[9][1] || '' : '',
                            hqPosition: teamInfoData[10] ? teamInfoData[10][1] || '' : '',
                            opsName: teamInfoData[13] ? teamInfoData[13][1] || '' : '',
                            opsEmail: teamInfoData[14] ? teamInfoData[14][1] || '' : '',
                            opsPhone: teamInfoData[15] ? teamInfoData[15][1] || '' : '',
                            opsPosition: teamInfoData[16] ? teamInfoData[16][1] || '' : ''
                        };
                    }
                    
                    // Import Assessment Data
                    if (workbook.Sheets['HID SCT Assessment']) {
                        const assessmentSheet = workbook.Sheets['HID SCT Assessment'];
                        const assessmentDataArray = XLSX.utils.sheet_to_json(assessmentSheet, { header: 1 });
                        
                        // Skip header row
                        for (let i = 1; i < assessmentDataArray.length; i++) {
                            const row = assessmentDataArray[i];
                            if (row.length >= 8) {
                                const standardId = row[0];
                                const standardStatement = row[2];
                                const score = row[3];
                                const evidence = row[4];
                                const gaps = row[5];
                                const actions = row[6];
                                const comments = row[7];
                                
                                assessmentData.scores[standardId] = score;
                                assessmentData.standard[standardId] = standardStatement;
                                assessmentData.evidence[standardId] = evidence;
                                assessmentData.gaps[standardId] = gaps;
                                assessmentData.actions[standardId] = actions;
                                
                                // Extract section from standardId for comments
                                const section = standardId.split('-').slice(0, -1).join('-');
                                if (section && comments) {
                                    assessmentData.comments[`${section}Comments`] = comments;
                                }
                            }
                        }
                    }
                    
                    // Import Summary
                    if (workbook.Sheets['Summary']) {
                        const summarySheet = workbook.Sheets['Summary'];
                        const summaryDataArray = XLSX.utils.sheet_to_json(summarySheet, { header: 1 });
                        
                        assessmentData.summary = {
                            strengths: summaryDataArray[1] ? summaryDataArray[1][1] || '' : '',
                            criticalGaps: summaryDataArray[2] ? summaryDataArray[2][1] || '' : '',
                            immediateActions: summaryDataArray[3] ? summaryDataArray[3][1] || '' : '',
                            shortTermActions: summaryDataArray[4] ? summaryDataArray[4][1] || '' : '',
                            mediumTermActions: summaryDataArray[5] ? summaryDataArray[5][1] || '' : '',
                            technicalAssistance: summaryDataArray[6] ? summaryDataArray[6][1] || '' : '',
                            trainingRequirements: summaryDataArray[7] ? summaryDataArray[7][1] || '' : '',
                            resourceRequirements: summaryDataArray[8] ? summaryDataArray[8][1] || '' : '',
                            nextSteps: summaryDataArray[9] ? summaryDataArray[9][1] || '' : '',
                            completionDate: summaryDataArray[10] ? summaryDataArray[10][1] || '' : '',
                            reviewedBy: summaryDataArray[11] ? summaryDataArray[11][1] || '' : '',
                            mentorAssignment: summaryDataArray[12] ? summaryDataArray[12][1] || '' : ''
                        };
                    }
                    
                    // Save to localStorage and update UI
                    localStorage.setItem('hidSCTAssessment', JSON.stringify(assessmentData));
                    renderDynamicRows(); // Render dynamic rows from imported data
                    loadSavedData();
                    updateProgress();
                    showNotification('Data imported successfully!');
                    
                    // Reset file input
                    document.getElementById('fileInput').value = '';
                } catch (error) {
                    console.error('Error importing Excel file:', error);
                    showNotification('Error importing Excel file. Please check the file format.');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function createNewRow(section) {
            const tableBody = document.querySelector(`tbody[data-section="${section}"]`);
            if (!tableBody) return;
            
            const randomId = Math.random().toString(36).substring(2, 9);
            const newItemId = `${section}-${randomId}`;

            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><textarea class="form-control standard-input" rows="2" placeholder="Describe el nuevo estándar"></textarea></td>
                <td>
                    <select class="form-select score-select" data-section="${section}" data-item="${newItemId}">
                        <option value="">-</option>
                        <option value="0">0 - Not started</option>
                        <option value="1">1 - Initial</option>
                        <option value="2">2 - In progress</option>
                        <option value="3">3 - Completed</option>
                        <option value="NA">N/A</option>
                    </select>
                </td>
                <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                <td><textarea class="form-control action-input" rows="2"></textarea></td>
                <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
            `;

            tableBody.appendChild(newRow);

            newRow.querySelector('.score-select').addEventListener('change', function() {
                updateScoreBadge(this);
                saveProgress();
            });
            newRow.querySelector('.remove-row').addEventListener('click', function() {
                if (confirm('¿Estás seguro de que quieres eliminar esta fila?')) {
                    newRow.remove();
                    delete assessmentData.scores[newItemId];
                    delete assessmentData.evidence[newItemId];
                    delete assessmentData.gaps[newItemId];
                    delete assessmentData.actions[newItemId];
                    delete assessmentData.standard[newItemId];
                    saveProgress();
                }
            });

            newRow.querySelectorAll('input, textarea, select').forEach(element => {
                element.addEventListener('change', saveProgress);
            });
        }

        function renderDynamicRows() {
            const sections = ['clinical-standards', 'logistic-standards', 'wash-standards'];
            sections.forEach(section => {
                const tableBody = document.querySelector(`tbody[data-section="${section}"]`);
                if (!tableBody) return;

                // Clear existing dynamic rows
                const existingDynamicRows = tableBody.querySelectorAll('tr');
                existingDynamicRows.forEach(row => {
                    const standardInput = row.querySelector('.standard-input');
                    if(standardInput) {
                        row.remove();
                    }
                });

                // Get dynamic items from loaded data
                const dynamicItems = Object.keys(assessmentData.scores).filter(key => key.startsWith(section) && !isStaticItem(key));
                
                dynamicItems.forEach(itemKey => {
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                        <td><textarea class="form-control standard-input" rows="2" placeholder="Describe el nuevo estándar">${assessmentData.standard[itemKey] || ''}</textarea></td>
                        <td>
                            <select class="form-select score-select" data-section="${section}" data-item="${itemKey}">
                                <option value="">-</option>
                                <option value="0">0 - Not started</option>
                                <option value="1">1 - Initial</option>
                                <option value="2">2 - In progress</option>
                                <option value="3">3 - Completed</option>
                                <option value="NA">N/A</option>
                            </select>
                        </td>
                        <td><textarea class="form-control evidence-input" rows="2">${assessmentData.evidence[itemKey] || ''}</textarea></td>
                        <td><textarea class="form-control gaps-input" rows="2">${assessmentData.gaps[itemKey] || ''}</textarea></td>
                        <td><textarea class="form-control action-input" rows="2">${assessmentData.actions[itemKey] || ''}</textarea></td>
                        <td><button class="btn btn-sm btn-danger remove-row"><i class="fas fa-trash"></i></button></td>
                    `;
                    tableBody.appendChild(newRow);
                    
                    const scoreSelect = newRow.querySelector('.score-select');
                    if (assessmentData.scores[itemKey]) {
                        scoreSelect.value = assessmentData.scores[itemKey];
                    }

                    newRow.querySelector('.score-select').addEventListener('change', function() {
                        updateScoreBadge(this);
                        saveProgress();
                    });
                    newRow.querySelector('.remove-row').addEventListener('click', function() {
                        if (confirm('¿Estás seguro de que quieres eliminar esta fila?')) {
                            newRow.remove();
                            delete assessmentData.scores[itemKey];
                            delete assessmentData.evidence[itemKey];
                            delete assessmentData.gaps[itemKey];
                            delete assessmentData.actions[itemKey];
                            delete assessmentData.standard[itemKey];
                            saveProgress();
                        }
                    });
                    newRow.querySelectorAll('input, textarea, select').forEach(element => {
                        element.addEventListener('change', saveProgress);
                    });
                });
            });
        }

        function isStaticItem(key) {
            const staticItems = [
                "guiding-principles-safe-care", "guiding-principles-equitable-care", "guiding-principles-ethical-care", "guiding-principles-accountable-response", "guiding-principles-appropriate-response", "guiding-principles-coordinated-response",
                "core-standards-admin-management", "core-standards-human-resources", "core-standards-professional-licensing", "core-standards-training-teams", "core-standards-coordination-emts", "core-standards-records-reporting",
                "clinical-standards-screening", "clinical-standards-triage", "clinical-standards-treatment", "clinical-standards-obstetric-care",
                "logistic-standards-power-fuel", "logistic-standards-communications", "logistic-standards-transportation", "logistic-standards-warehouse",
                "wash-standards-water-supply", "wash-standards-hygiene", "wash-standards-cleaning", "wash-standards-waste-management"
            ];
            return staticItems.includes(key);
        }


        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize data
            initializeData();
            
            // Add change listeners for scores
            document.querySelectorAll('.score-select').forEach(select => {
                select.addEventListener('change', function() {
                    updateScoreBadge(this);
                    saveProgress();
                });
            });
            
            // Add input listeners for text fields
            document.querySelectorAll('input, textarea, select').forEach(element => {
                element.addEventListener('change', function() {
                    saveProgress();
                });
            });
            
            // Set today's date as default for assessment date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('completionDate').value = today;
            
            // Add event listeners for buttons
            document.getElementById('btn-save').addEventListener('click', saveProgress);
            document.getElementById('btn-export-json').addEventListener('click', exportToJSON);
            document.getElementById('btn-export-excel').addEventListener('click', exportToExcel);
            document.getElementById('btn-submit').addEventListener('click', function() {
                saveProgress();
                showNotification('Assessment submitted successfully!');
            });
            
            // Import functionality
            document.getElementById('btn-import-excel').addEventListener('click', function() {
                document.getElementById('fileInput').click();
            });
            document.getElementById('fileInput').addEventListener('change', importFromExcel);
            
            // Add dynamic row functionality
            document.querySelectorAll('.add-row').forEach(button => {
                button.addEventListener('click', function() {
                    createNewRow(this.dataset.section);
                });
            });
            
            document.querySelectorAll('.remove-row').forEach(button => {
                button.addEventListener('click', function() {
                    if (confirm('¿Estás seguro de que quieres eliminar esta fila?')) {
                        const row = this.closest('tr');
                        const scoreSelect = row.querySelector('.score-select');
                        const key = `${scoreSelect.dataset.section}-${scoreSelect.dataset.item}`;

                        row.remove();
                        delete assessmentData.scores[key];
                        delete assessmentData.evidence[key];
                        delete assessmentData.gaps[key];
                        delete assessmentData.actions[key];
                        saveProgress();
                    }
                });
            });

            // Initialize tab functionality
            const triggerTabList = document.querySelectorAll('.nav-link');
            triggerTabList.forEach(triggerEl => {
                triggerEl.addEventListener('click', function (event) {
                    event.preventDefault();
                    const target = this.getAttribute('href');
                    
                    // Update active tab
                    triggerTabList.forEach(tab => {
                        tab.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show target tab content
                    document.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.remove('show', 'active');
                    });
                    document.querySelector(target).classList.add('show', 'active');
                });
            });
        });
    </script>
</body>
</html>